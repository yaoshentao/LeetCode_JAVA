package cn.ques8;

public class Solution {
     public int myAtoi(String str) {
            int len = str.length();

            // 去除前导空格
            int index = 0;
            while (index < len) {
                if (str.charAt(index) != ' ') {
                    break;
                }
                index++;
            }

            if (index == len) {
                return 0;
            }

            // 第 1 个字符如果是符号，判断合法性，并记录正负
            int sign = 1;
            char firstChar = str.charAt(index);
            if (firstChar == '+') {
                index++;
                sign = 1;
            } else if (firstChar == '-') {
                index++;
                sign = -1;
            }

            // 不能使用 long 类型，这是题目说的
            int res = 0;
            while (index < len) {
                char currChar = str.charAt(index);
                // 判断合法性
                if (currChar > '9' || currChar < '0') {
                    break;
                }

                // 题目中说：环境只能存储 32 位大小的有符号整数，因此，需要提前判断乘以 10 以后是否越界
                if (res > Integer.MAX_VALUE / 10 || (res == Integer.MAX_VALUE / 10 && (currChar - '0') > Integer.MAX_VALUE % 10)) {
                    return Integer.MAX_VALUE;
                }
                if (res < Integer.MIN_VALUE / 10 || (res == Integer.MIN_VALUE / 10 && (currChar - '0') > -(Integer.MIN_VALUE % 10))) {
                    return Integer.MIN_VALUE;
                }

                // 每一步都把符号位乘进去
                res = res * 10 + sign * (currChar - '0');
                index++;
            }
            return res;
     }
}